<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Mots croisés – Grille 25-297</title>
  <style>
    :root{
  --cell: min(7.2vw, 44px);
  --gap: 2px;
  --bg: #ffffff;
  --ink: #111111;
  --muted: #666666;
  --black: #111111;
  --border: #cccccc;
  --focus: #000000;
  --radius: 10px;
}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:#f6f6f6;
      color:var(--ink);
    }
    header{
      position: sticky;
      top: 0;
      z-index: 10;
      background: var(--bg);
      border-bottom: 1px solid #e8e8e8;
      padding: 14px 14px 10px;
    }
    h1{
      margin:0 0 6px 0;
      font-size: 18px;
      line-height: 1.2;
    }
    .sub{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      color:var(--muted);
      font-size: 13px;
    }
    .pill{
      display:inline-flex;
      gap:8px;
      align-items:center;
      padding: 6px 10px;
      border:1px solid #e6e6e6;
      border-radius: 999px;
      background:#fafafa;
      color:#333;
      cursor:pointer;
      user-select:none;
    }
    .pill:active{ transform: translateY(1px); }
    .wrap{
      max-width: 920px;
      margin: 0 auto;
      padding: 14px;
      padding-bottom: 30px;
    }
    .card{
      background: var(--bg);
      border: 1px solid #e9e9e9;
      border-radius: var(--radius);
      box-shadow: 0 1px 8px rgba(0,0,0,.04);
      padding: 14px;
      margin-bottom: 14px;
    }
    .gridTitle{
      display:flex;
      justify-content: space-between;
      align-items:center;
      gap: 10px;
      margin-bottom: 10px;
    }
    .gridTitle b{ font-size: 16px; }
    .autosave{
      font-size: 12px;
      color: var(--muted);
      display:flex;
      align-items:center;
      gap:6px;
      white-space:nowrap;
    }
    .dot{
      width:8px; height:8px; border-radius:50%;
      background:#18a558;
      display:inline-block;
    }

    /* Grille avec entêtes (1 colonne + 12 cols) x (1 ligne + 10 lignes) */
    .gridWrap{
      overflow:auto;
      -webkit-overflow-scrolling: touch;
      padding-bottom: 4px;
    }
    .grid{
      display:grid;
      grid-template-columns: calc(var(--cell) * 0.72) repeat(12, var(--cell));
      grid-template-rows: calc(var(--cell) * 0.72) repeat(10, var(--cell));
      gap: var(--gap);
      align-items: stretch;
      justify-items: stretch;
      width: max-content;
      margin: 0 auto;
    }
    .hdr{
      display:flex;
      align-items:center;
      justify-content:center;
      font-size: 12px;
      color:#333;
      background:#f3f3f3;
      border:1px solid #e1e1e1;
      border-radius: 10px;
      user-select:none;
    }
    .corner{ background: transparent; border: none; }
    .cell, .blk{
      border: 1px solid var(--border);
      border-radius: 10px;
      box-sizing: border-box;
    }
    .blk{
      background: var(--black);
      border-color: var(--black);
    }
    input.cell{
      width: 100%;
      height: 100%;
      text-align:center;
      font-size: 20px;
      font-weight: 650;
      border: 1px solid var(--border);
      outline:none;
      background: #fff;
      color: var(--ink);
      text-transform: uppercase;
      caret-color: transparent;
      padding:0;
    }
    input.cell:focus{
      border-color: var(--focus);
      box-shadow: 0 0 0 2px rgba(0,0,0,.08);
    }

    .hint{
      margin-top: 10px;
      color: var(--muted);
      font-size: 13px;
    }

    h2{
      margin: 0 0 8px 0;
      font-size: 16px;
    }
    .clues{
      display:grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }
    @media(min-width: 860px){
      .clues{ grid-template-columns: 1fr 1fr; }
    }
    .clueBlock{
      background:#fff;
      border:1px solid #eee;
      border-radius: var(--radius);
      padding: 12px;
    }
    .clueBlock h3{
      margin:0 0 8px 0;
      font-size: 14px;
      letter-spacing: .02em;
      text-transform: uppercase;
    }
    .clueList{
      margin:0;
      padding-left: 18px;
      color:#222;
      line-height: 1.35;
      font-size: 14px;
    }
    .clueList li{ margin: 6px 0; }
    .footerNote{
      margin-top: 8px;
      font-size: 12px;
      color: var(--muted);
    }
  </style>
</head>

<body>
<header>
  <h1>Mots croisés – Grille n°25-297 (à remplir)</h1>
  <div class="sub">
    <div class="pill" id="btnClear">Effacer la grille</div>
    <div class="pill" id="btnCopy">Copier ma grille (texte)</div>
  </div>
</header>

<div class="wrap">
  <div class="card">
    <div class="gridTitle">
      <b>Grille (10 × 12)</b>
      <div class="autosave"><span class="dot"></span> Sauvegarde auto ✓</div>
    </div>

    <div class="gridWrap">
      <div class="grid" id="grid"></div>
    </div>

    <div class="hint">
      Astuce : tape une lettre → passe automatiquement à la case suivante. Retour arrière = case précédente. Flèches = navigation.
    </div>
  </div>

  <div class="card">
    <h2>Définitions</h2>
    <div class="clues">
      <div class="clueBlock">
        <h3>Horizontalement</h3>
        <ol class="clueList" type="I">
          <li>S’installa dans les bras d’Hypnos. Boules hollandaises.</li>
          <li>Dure essence des tropiques. Drame lyrique souvent sacré.</li>
          <li>Leurs danses et leur fumée font des volutes. Carte sur table.</li>
          <li>Vous pouvez le chercher longtemps. Vieux messieurs.</li>
          <li>Espace qui laisse une trace une fois renversé. Déesse de l’aurore. Paresseux.</li>
          <li>Fit tomber les prunes. Communauté paysanne russe.</li>
          <li>Partie de la partie. Eut confiance.</li>
          <li>Espace de choix. Part aussi du coeur.</li>
          <li>Tombait froidement en douceur.</li>
          <li>Pièges. Manifestation d’hostilité.</li>
        </ol>
      </div>

      <div class="clueBlock">
        <h3>Verticalement</h3>
        <ol class="clueList">
          <li>Bon ou mauvais moyen pour sortir du sujet.</li>
          <li>Chargées de substances calmantes et dangereuses.</li>
          <li>Rejetons notre propos.</li>
          <li>Danoise en mer Baltique. Article.</li>
          <li>Enfant de Créuse. S’adresse avec familiarité.</li>
          <li>Donne de l’intensité. Chasse le poulet faisandé.</li>
          <li>Partie du monde. Découpage historique.</li>
          <li>Conjonction. Vents mauvais. Interjection.</li>
          <li>Sommets montagneux. Lâcha les gaz.</li>
          <li>Dieu de la violence et de la guerre. Créai le désordre.</li>
          <li>Unité de temps. Fait sonner les cloches.</li>
          <li>N’a sûrement pas ce qu’elle désire.</li>
        </ol>
      </div>
    </div>

    <div class="footerNote">
      (Remarque : cette page ne calcule pas la solution ; elle sert à remplir et conserver votre saisie.)
    </div>
  </div>
</div>

<script>
(function(){
  const PUZZLE_ID = "mots-croises-25-297";
  const rows = 10, cols = 12;

  // Noir = 1, Blanc = 0
  // D'après la grille (10x12) : noirs aux positions :
  // (1,7), (2,4), (3,8), (4,5)(4,11), (5,6)(5,10), (6,7)(6,9),
  // (7,4)(7,6), (8,8), (9,2), (10,7)
  const blacks = new Set([
    key(1,7),
    key(2,4),
    key(3,8),
    key(4,5), key(4,11),
    key(5,6), key(5,10),
    key(6,7), key(6,9),
    key(7,4), key(7,6),
    key(8,8),
    key(9,2),
    key(10,7)
  ]);

  const roman = ["I","II","III","IV","V","VI","VII","VIII","IX","X"];

  const gridEl = document.getElementById("grid");
  const btnClear = document.getElementById("btnClear");
  const btnCopy = document.getElementById("btnCopy");

  // --- Build grid with headers ---
  // (0,0) corner
  gridEl.appendChild(makeHdr("", true));

  // Top headers 1..12
  for(let c=1;c<=cols;c++){
    const h = makeHdr(String(c));
    gridEl.appendChild(h);
  }

  // Rows
  for(let r=1;r<=rows;r++){
    // Left header roman
    gridEl.appendChild(makeHdr(roman[r-1]));

    for(let c=1;c<=cols;c++){
      if(blacks.has(key(r,c))){
        const blk = document.createElement("div");
        blk.className = "blk";
        blk.setAttribute("aria-label", `Noir ${roman[r-1]}-${c}`);
        gridEl.appendChild(blk);
      } else {
        const inp = document.createElement("input");
        inp.className = "cell";
        inp.type = "text";
        inp.inputMode = "latin";
        inp.maxLength = 1;
        inp.autocomplete = "off";
        inp.spellcheck = false;
        inp.dataset.r = r;
        inp.dataset.c = c;
        inp.setAttribute("aria-label", `Case ${roman[r-1]}-${c}`);

        inp.addEventListener("input", (e) => {
          const v = (inp.value || "").toUpperCase();
          inp.value = (v.match(/[A-ZÀÂÄÇÉÈÊËÎÏÔÖÙÛÜŸÆŒ]/i) ? v[0] : "");
          save();
          if(inp.value){
            focusNext(r,c);
          }
        });

        inp.addEventListener("keydown", (e) => {
          const k = e.key;

          if(k === "Backspace"){
            if(inp.value){
              inp.value = "";
              save();
              e.preventDefault();
              return;
            }
            e.preventDefault();
            focusPrev(r,c);
            return;
          }

          if(k === "ArrowRight"){ e.preventDefault(); focusNext(r,c); return; }
          if(k === "ArrowLeft"){ e.preventDefault(); focusPrev(r,c); return; }
          if(k === "ArrowDown"){ e.preventDefault(); focusDown(r,c); return; }
          if(k === "ArrowUp"){ e.preventDefault(); focusUp(r,c); return; }

          // Enter = go next
          if(k === "Enter"){ e.preventDefault(); focusNext(r,c); return; }
        });

        gridEl.appendChild(inp);
      }
    }
  }

  // --- Load saved ---
  load();

  // --- Buttons ---
  btnClear.addEventListener("click", () => {
    if(!confirm("Effacer toutes les lettres de la grille ?")) return;
    document.querySelectorAll("input.cell").forEach(i => i.value = "");
    save();
    // focus first
    const first = document.querySelector('input.cell');
    if(first) first.focus();
  });

  btnCopy.addEventListener("click", async () => {
    const text = exportText();
    try{
      await navigator.clipboard.writeText(text);
      alert("Grille copiée dans le presse-papiers ✅");
    }catch(err){
      // fallback
      prompt("Copiez ce texte :", text);
    }
  });

  // --- Helpers ---
  function key(r,c){ return r + "," + c; }

  function makeHdr(txt, isCorner=false){
    const d = document.createElement("div");
    d.className = "hdr" + (isCorner ? " corner" : "");
    d.textContent = txt;
    return d;
  }

  function cellAt(r,c){
    return document.querySelector(`input.cell[data-r="${r}"][data-c="${c}"]`);
  }

  function isBlack(r,c){
    return blacks.has(key(r,c));
  }

  function focusNext(r,c){
    // move to next white cell (row-major)
    let rr=r, cc=c;
    for(let n=0;n<rows*cols;n++){
      cc++;
      if(cc>cols){ cc=1; rr++; }
      if(rr>rows){ rr=1; }
      if(!isBlack(rr,cc)){
        const el = cellAt(rr,cc);
        if(el){ el.focus(); return; }
      }
    }
  }

  function focusPrev(r,c){
    let rr=r, cc=c;
    for(let n=0;n<rows*cols;n++){
      cc--;
      if(cc<1){ cc=cols; rr--; }
      if(rr<1){ rr=rows; }
      if(!isBlack(rr,cc)){
        const el = cellAt(rr,cc);
        if(el){ el.focus(); return; }
      }
    }
  }

  function focusDown(r,c){
    let rr=r, cc=c;
    for(let n=0;n<rows;n++){
      rr++;
      if(rr>rows) rr=1;
      if(!isBlack(rr,cc)){
        const el = cellAt(rr,cc);
        if(el){ el.focus(); return; }
      }
    }
  }

  function focusUp(r,c){
    let rr=r, cc=c;
    for(let n=0;n<rows;n++){
      rr--;
      if(rr<1) rr=rows;
      if(!isBlack(rr,cc)){
        const el = cellAt(rr,cc);
        if(el){ el.focus(); return; }
      }
    }
  }

  function save(){
    const data = {};
    document.querySelectorAll("input.cell").forEach(i => {
      const r = i.dataset.r, c = i.dataset.c;
      data[key(r,c)] = i.value || "";
    });
    localStorage.setItem(PUZZLE_ID, JSON.stringify(data));
  }

  function load(){
    const raw = localStorage.getItem(PUZZLE_ID);
    if(!raw) return;
    let data=null;
    try{ data = JSON.parse(raw); }catch(e){ return; }
    document.querySelectorAll("input.cell").forEach(i => {
      const k = key(i.dataset.r, i.dataset.c);
      if(typeof data[k] === "string") i.value = data[k];
    });
  }

  function exportText(){
    // export grille en 10 lignes, avec # pour noir, . pour vide, lettre sinon
    const lines = [];
    for(let r=1;r<=rows;r++){
      let line = "";
      for(let c=1;c<=cols;c++){
        if(isBlack(r,c)) line += "#";
        else{
          const v = (cellAt(r,c)?.value || "");
          line += v ? v.toUpperCase() : ".";
        }
      }
      lines.push(roman[r-1] + " " + line);
    }
    return [
      "Mots croisés – Grille 25-297",
      "",
      ...lines,
      "",
      "Légende : # = noir, . = vide"
    ].join("\n");
  }
})();
</script>
</body>
</html>
